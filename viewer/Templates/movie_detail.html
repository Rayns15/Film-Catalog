{% extends 'base.html' %}
{% load static %}

{% block title %}{{ movie.title }}{% endblock %}

{% block content %}
<style>
    /* Stiluri specifice paginii */
    .card {
        background: rgba(31, 41, 55, 0.5);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: opacity 0.4s ease-out, transform 0.2s ease-out;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .fade-in {
        animation: fadeIn 0.8s ease-out forwards;
    }
    .home-btn {
        background-color: #3b82f6;
        transition: background-color 0.3s ease, transform 0.2s ease;
    }
    .home-btn:hover {
        background-color: #2563eb;
        transform: translateY(-2px);
    }
</style>

<div class="flex flex-grow items-center justify-center p-4 py-12">

    <div id="movie-card" class="card rounded-2xl shadow-2xl max-w-4xl w-full overflow-hidden fade-in">
        <div class="md:flex">
            
            <div class="md:w-1/3">
                {% if movie.profile_picture %}
                    <img class="h-full w-full object-cover" src="{{ movie.profile_picture.url }}" alt="{{ movie.title }} Poster">
                {% else %}
                    <img class="h-full w-full object-cover" src="{% static 'logos/placeholder.jpg' %}" alt="{{ movie.title }} Poster">
                {% endif %}
            </div>

            <div class="p-8 md:p-10 md:w-2/3">
                
                <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">{{ movie.title }}</h1>
                
                {% if movie.rating %}
                <div class="flex items-center mb-6">
                    {% for i in "12345" %}
                        {% if movie.rating >= i|add:0 %}
                            <svg class="w-5 h-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.54-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>
                        {% else %}
                            <svg class="w-5 h-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.31h5.518a.563.563 0 01.32.934l-4.09 2.985a.563.563 0 00-.192.54l1.54 4.73a.563.563 0 01-.816.626l-4.09-2.985a.563.563 0 00-.65 0l-4.09 2.985a.563.563 0 01-.816-.626l1.54-4.73a.563.563 0 00-.192-.54L2.036 9.854a.563.563 0 01.32-.934h5.518a.563.563 0 00.475-.31L11.48 3.5z" /></svg>
                        {% endif %}
                    {% endfor %}
                </div>
                {% endif %}

                <div class="text-gray-300 space-y-4 text-justify">
                    <p>{{ movie.bio|linebreaksbr }}</p>
                </div>

                <div class="mt-8">
                    <h3 class="text-xl font-bold text-white mb-3">Details</h3>
                    <ul class="list-disc list-inside text-gray-300">
                        <li>Director: {{ movie.director }}</li>
                        <li>Year: {{ movie.year }}</li>
                        <li>Genre: {{ movie.genre_movie }}</li>
                    </ul>
                </div>
                
                <div class="mt-10 text-center">
                    <a href="{% url 'viewer:home' %}" class="home-btn inline-block text-white font-bold py-3 px-8 rounded-lg shadow-lg">
                        Return Home
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}


{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const card = document.getElementById('movie-card');
        const homeButton = document.querySelector('.home-btn');
        const body = document.body;

        // --- 3D Tilt Effect ---
        if (card) {
            card.addEventListener('mousemove', (e) => {
                const { left, top, width, height } = card.getBoundingClientRect();
                const x = e.clientX - left;
                const y = e.clientY - top;
                const rotateY = -1 * ((x - width / 2) / (width / 2)) * 5;
                const rotateX = ((y - height / 2) / (height / 2)) * 5;
                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
            });

            card.addEventListener('mouseleave', () => {
                card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg)';
            });
        }
        
        // --- Smooth Exit Transition ---
        if (homeButton) {
            homeButton.addEventListener('click', (e) => {
                if (e.defaultPrevented) return; 
                e.preventDefault(); 
                const targetUrl = homeButton.href;
                
                if (card) {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                }
                setTimeout(() => {
                    if (body) {
                        body.classList.add('fade-out');
                    }
                    setTimeout(() => {
                        window.location.href = targetUrl;
                    }, 500); 
                }, 200); 
            });
        }

        window.addEventListener('beforeunload', () => {
            if (body) {
               body.classList.add('fade-out');
            }
        });
    });
</script>
{% endblock %}